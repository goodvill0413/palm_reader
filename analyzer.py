# analyzer.py
# -*- coding: utf-8 -*-

import cv2
import numpy as np
from typing import Dict, Any
import random

class PalmAnalyzer:
    def __init__(self):
        # ì†ê¸ˆ ë¶„ì„ ë°ì´í„°
        self.palm_data = {
            'lines': {
                'ê°ì •ì„ ': {
                    'icon': 'ğŸ’•',
                    'title': 'ê°ì •ì„  (Heart Line)',
                    'analysis': '''ì„ ëª…í•˜ê²Œ ë³´ì´ë‹ˆ ë”°ëœ»í•œ ë§ˆìŒì´ ì˜ ì „ë‹¬ë˜ê³ , ê³¡ì„ ì´ ì•„ë¦„ë‹µê²Œ ë³´ì´ë‹ˆ ì°½ì˜ì ì¸ ê´€ê³„ê°€ ê¸°ëŒ€ë˜ê³ , ê¸¸ê²Œ ë»—ì–´ ìˆìœ¼ë‹ˆ ê¹Šì€ ìš°ì •ê³¼ ì‚¬ë‘ì´ ì§€ì†ë˜ê³  ìˆì–´.

ê°ì •ì„ ì€ ë‹¹ì‹ ì˜ ì‚¬ë‘ê³¼ ìš°ì •ì„ ë‹´ë‹¹í•˜ëŠ” íŠ¹ë³„í•œ ì„ ì´ì•¼. ë‘ê»ê²Œ ë³´ì´ë‹ˆ ê°ì •ì´ í’ë¶€í•˜ê³ , ì ë‹¹í•œ ê¹Šì´ë¡œ ìƒˆê²¨ì ¸ ìˆìœ¼ë‹ˆ ì§„ì‹¤í•œ ë§ˆìŒì„ ê°€ì§€ê³  ìˆì–´.

ì†ì„ í¸ì•ˆíˆ í´ê³  ìì—°ê´‘ ì•„ë˜ì—ì„œ ë‹¤ì‹œ ì°ì–´ë³´ë©´ ì´ ì„ ì˜ ë§¤ë ¥ì´ ë” ì˜ ë“œëŸ¬ë‚  ê±°ì•¼. ì•ìœ¼ë¡œ ìƒˆë¡œìš´ ë§Œë‚¨ì—ì„œ íŠ¹ë³„í•œ ì¸ì—°ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì„ ê²ƒ ê°™ì•„!'''
                },
                'ì§€ëŠ¥ì„ ': {
                    'icon': 'ğŸ§ ',
                    'title': 'ì§€ëŠ¥ì„  (Head Line)',
                    'analysis': '''ì§ì„ ì— ê°€ê¹ê²Œ ë³´ì´ë‹ˆ ëª©í‘œê°€ ë‹¨ë‹¨í•´ì§€ê³ , ì„ ëª…í•˜ë‹ˆ ëª…ì„í•¨ì´ ì˜ ë“œëŸ¬ë‚˜ê³ , ì ë‹¹í•œ ê¸¸ì´ë‹ˆ ì‹¤ìš©ì  ì‚¬ê³ ê°€ ë›°ì–´ë‚˜ê³ , ê¹Šì´ ìˆê²Œ ìƒˆê²¨ì ¸ ìˆìœ¼ë‹ˆ ì—´ì •ì´ ë‹´ê¸°ê³  ìˆì–´.

ì§€ëŠ¥ì„ ì€ ë‹¹ì‹ ì˜ ì‚¬ê³ ì™€ ì°½ì˜ë ¥ì„ ë³´ì—¬ì£¼ëŠ” ì¤‘ìš”í•œ ì„ ì´ì•¼. ë¶„ê¸°ê°€ ë³´ì´ë‹ˆ ë‹¤ì–‘í•œ ì•„ì´ë””ì–´ê°€ ìƒ˜ì†Ÿê³ , ê· í˜•ì¡íŒ ëª¨ìŠµì´ë‹ˆ ë…¼ë¦¬ì  ì‚¬ê³ ì™€ ì°½ì˜ì  ì˜ê°ì´ ì¡°í™”ë¥¼ ì´ë£¨ê³  ìˆì–´.

ëª…ìƒì´ë‚˜ ì•„ì´ë””ì–´ ì ê¸°ë¥¼ í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê±°ì•¼. ìƒˆë¡œìš´ ë„ì „ì—ì„œ ë‹¹ì‹ ì˜ ì§€ì  ëŠ¥ë ¥ì´ ë¹›ì„ ë°œí•  ë•Œê°€ ë‹¤ê°€ì˜¤ê³  ìˆì–´!'''
                },
                'ìƒëª…ì„ ': {
                    'icon': 'ğŸ’ª', 
                    'title': 'ìƒëª…ì„  (Life Line)',
                    'analysis': '''ì—„ì§€ ì£¼ë³€ì„ ì•„ë¦„ë‹µê²Œ ê°ì‹¸ëŠ” ê³¡ì„ ì´ ë³´ì´ë‹ˆ ì‚¶ì´ ìœ ì—°í•´ì§€ê³ , ê¹Šê³  ì„ ëª…í•˜ë‹ˆ í™œë ¥ì´ ì˜ ë“œëŸ¬ë‚˜ê³ , ê¸¸ê²Œ ì´ì–´ì ¸ ìˆìœ¼ë‹ˆ íšŒë³µë ¥ì´ ê°•í•˜ê³ , ì•ˆì •ì ì¸ í˜¸ë¥¼ ê·¸ë¦¬ë‹ˆ ì—ë„ˆì§€ê°€ ì˜ ìˆœí™˜ë˜ê³  ìˆì–´.

ìƒëª…ì„ ì€ ë‹¹ì‹ ì˜ ê±´ê°•ê³¼ ìƒëª…ë ¥ì„ ë‚˜íƒ€ë‚´ëŠ” ì†Œì¤‘í•œ ì„ ì´ì•¼. ë‘ê»ê²Œ ë³´ì´ë‹ˆ ì²´ë ¥ì´ ì¢‹ê³ , ì—°ì†ì„±ì´ ìˆìœ¼ë‹ˆ ê¾¸ì¤€í•œ ì—ë„ˆì§€ê°€ í˜ëŸ¬.

ìŠ¤íŠ¸ë ˆì¹­ì´ë‚˜ ì‚°ì±…ìœ¼ë¡œ ì´ íŠ¼íŠ¼í•¨ì„ ìœ ì§€í•´ë³´ì. ì•ìœ¼ë¡œë„ ê±´ê°•í•˜ê³  í™œê¸°ì°¬ ì‚¶ì´ ì§€ì†ë  ê±°ì•¼!'''
                },
                'ìš´ëª…ì„ ': {
                    'icon': 'â­',
                    'title': 'ìš´ëª…ì„  (Fate Line)',
                    'analysis': '''ì†ëª© ê·¼ì²˜ì—ì„œ ìœ„ë¡œ í–¥í•˜ëŠ” ì„ ì´ ë³´ì´ë‹ˆ ìƒˆë¡œìš´ ê¸°íšŒë¥¼ íƒìƒ‰í•œ ê³¼ì •ì´ ë˜ê³ , ìˆ˜ì§ìœ¼ë¡œ ë»—ì–´ ìˆìœ¼ë‹ˆ ëª©í‘œê°€ ëšœë ·í•´ì§€ê³ , ì¤‘ê°„ì— ë³€í™”ê°€ ìˆìœ¼ë‹ˆ ë‹¤ì–‘í•œ ê¸¸ì´ ì—´ë¦¬ê³  ìˆì–´.

ìš´ëª…ì„ ì€ ë‹¹ì‹ ì˜ ì¸ìƒ ë°©í–¥ê³¼ ëª©í‘œ ë‹¬ì„±ì„ ë³´ì—¬ì£¼ëŠ” ì‹ ë¹„ë¡œìš´ ì„ ì´ì•¼. ì„ ëª…í•œ ë¶€ë¶„ì´ ìˆìœ¼ë‹ˆ ê²°ë‹¨ë ¥ì´ ê°•í•˜ê³ , ê¹Šì´ê°€ ëŠê»´ì§€ë‹ˆ ì¸ë‚´ì‹¬ë„ ì¶©ë¶„í•´.

ì‘ì€ ëª©í‘œë¥¼ ì„¸ì›Œ í•˜ë‚˜ì”© ì´ë¤„ë³´ì. ë‹¹ì‹ ì˜ ìš´ëª…ì„ ì€ í° ì„±ì·¨ë¥¼ ì˜ˆê³ í•˜ê³  ìˆì–´!'''
                },
                'íƒœì–‘ì„ ': {
                    'icon': 'â˜€ï¸',
                    'title': 'íƒœì–‘ì„  (Sun Line)',
                    'analysis': '''ì•½ì§€ ì•„ë˜ ë¶€ë¶„ì— í¬ë¯¸í•˜ê²Œ ë³´ì´ë‹ˆ ìƒˆë¡œìš´ ë„ì „ì„ í†µí•´ ë¹›ë‚  ê¸°íšŒê°€ ë˜ê³ , ìƒìŠ¹í•˜ëŠ” ë°©í–¥ì´ë‹ˆ ì°½ì˜ì ì¸ ì„±ì·¨ê°€ ê¸°ëŒ€ë˜ê³ , ì„ ëª…í•´ì§ˆìˆ˜ë¡ ëª…ì˜ˆì™€ ì„±ê³µì´ ë”°ë¼ì˜¤ê³  ìˆì–´.

íƒœì–‘ì„ ì€ ë‹¹ì‹ ì˜ ì„±ê³µê³¼ ëª…ì˜ˆë¥¼ ë‹´ë‹¹í•˜ëŠ” í™©ê¸ˆ ê°™ì€ ì„ ì´ì•¼. ê³¡ì„ ì´ ì•„ë¦„ë‹¤ìš°ë‹ˆ ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ìˆê³ , ì ë‹¹í•œ ê¸¸ì´ë‹ˆ ì‹¤í˜„ ê°€ëŠ¥í•œ ê¿ˆì„ ê°€ì§€ê³  ìˆì–´.

ìì‹ ë§Œì˜ ì•„ì´ë””ì–´ë¥¼ ì‹¤ì²œí•´ë³´ì. íƒœì–‘ì„ ì´ ë”ìš± ì„ ëª…í•´ì§ˆ ë‚ ì´ ë©€ì§€ ì•Šì•˜ì–´!'''
                },
                'ê¸ˆì„±ë ': {
                    'icon': 'ğŸ’«',
                    'title': 'ê¸ˆì„±ë  (Girdle of Venus)',
                    'analysis': '''ê°ì •ì„  ìœ„ìª½ì— ì„¬ì„¸í•œ ì„ ë“¤ì´ ë³´ì´ë‹ˆ ê°ì •ì„ ììœ ë¡­ê²Œ í‘œí˜„í•  ë•Œê°€ ë˜ê³ , ì˜ˆìˆ ì  ê°ì„±ì´ í’ë¶€í•´ì§€ê³ , ì°½ì˜ì ì¸ ì¬ëŠ¥ì´ ê½ƒí”¼ìš°ê³  ìˆì–´.

ê¸ˆì„±ë ëŠ” ë‹¹ì‹ ì˜ ì˜ˆìˆ ì  ê°ìˆ˜ì„±ê³¼ ì„¬ì„¸í•œ ê°ì •ì„ ë³´ì—¬ì£¼ëŠ” íŠ¹ë³„í•œ ì„ ì´ì•¼. ë¶€ë“œëŸ¬ìš´ ê³¡ì„ ì´ë‹ˆ ë¡œë§¨í‹±í•œ ì„±í–¥ì´ ìˆê³ , ë¶„ê¸°ëœ ëª¨ìŠµì´ë‹ˆ ë‹¤ì–‘í•œ ì°½ì‘ í™œë™ì— ì¬ëŠ¥ì´ ìˆì–´.

ì†ìœ¼ë¡œ ê·¸ë¦¼ì´ë‚˜ ìŒì•…ì„ í•´ë³´ëŠ” ê²ƒë„ ì¢‹ì„ ê±°ì•¼. ë‹¹ì‹ ì˜ ê°ì„±ì´ ë§ì€ ì‚¬ëŒë“¤ì—ê²Œ ê°ë™ì„ ì¤„ ìˆ˜ ìˆì„ ê±°ì•¼!'''
                },
                'ê²°í˜¼ì„ ': {
                    'icon': 'ğŸ’’',
                    'title': 'ê²°í˜¼ì„  (Marriage Line)',
                    'analysis': '''ìƒˆë¼ì†ê°€ë½ ì•„ë˜ ì˜†ë©´ì— ì„ ë“¤ì´ ë³´ì´ë‹ˆ ê´€ê³„ì—ì„œ ìƒˆë¡œìš´ ì¡°ìœ¨ì˜ ì‹œê°„ì´ ë˜ê³ , ì•ˆì •ì ì¸ ë™ë°˜ìì„±ì´ ê°•í•´ì§€ê³ , ê¹Šì€ ì• ì •ì´ ë‹´ê²¨ ìˆì–´.

ê²°í˜¼ì„ ì€ ë‹¹ì‹ ì˜ ì‚¬ë‘ê³¼ ê²°í˜¼ìš´ì„ ë³´ì—¬ì£¼ëŠ” ë¡œë§¨í‹±í•œ ì„ ì´ì•¼. ì§ì„ ì— ê°€ê¹Œìš°ë‹ˆ ì‹ ë¢°ê°€ ë‹¨ë‹¨í•˜ê³ , ì ë‹¹í•œ ë‘ê»˜ë‹ˆ ê· í˜•ì¡íŒ ê´€ê³„ë¥¼ ì¶”êµ¬í•´.

ëŒ€í™”ë¡œ ê´€ê³„ë¥¼ ë” ë”°ëœ»í•˜ê²Œ ë§Œë“¤ì–´ë³´ì. ì§„ì •í•œ ì‚¬ë‘ì´ ë‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´!'''
                },
                'ìš´ì„¸ì„ ': {
                    'icon': 'ğŸŒŠ',
                    'title': 'ìš´ì„¸ì„  (Via Lasciva)',
                    'analysis': '''ì†ë°”ë‹¥ ì•„ë˜ìª½ì— ê³¡ì„ ë“¤ì´ ë³´ì´ë‹ˆ ìƒˆë¡œìš´ ëª¨í—˜ì„ ì‹œì‘í•  ì¤€ë¹„ê°€ ë˜ê³ , ë‹¤ì±„ë¡œìš´ ê²½í—˜ì´ ë§ì•„ì§€ê³ , ììœ ë¡œìš´ ì •ì‹ ì´ ë¹›ë‚˜ê³  ìˆì–´.

ìš´ì„¸ì„ ì€ ë‹¹ì‹ ì˜ ëª¨í—˜ì‹¬ê³¼ ììœ ë¡œìš´ ì˜í˜¼ì„ ë³´ì—¬ì£¼ëŠ” ì—­ë™ì ì¸ ì„ ì´ì•¼. ë¬¼ê²°ì²˜ëŸ¼ íë¥´ë‹ˆ ë³€í™”ë¥¼ ì¦ê¸°ê³ , ì—¬ëŸ¬ ê°ˆë˜ë¡œ ë‚˜ë‰˜ë‹ˆ ë‹¤ì–‘í•œ ê²½í—˜ì„ ì¶”êµ¬í•´.

ì—¬í–‰ì´ë‚˜ ì·¨ë¯¸ë¡œ ì´ ì—ë„ˆì§€ë¥¼ ì¦ê²¨ë³´ì. ìƒˆë¡œìš´ ë„ì „ì´ ë‹¹ì‹ ì—ê²Œ íŠ¹ë³„í•œ í–‰ìš´ì„ ê°€ì ¸ë‹¤ ì¤„ ê±°ì•¼!'''
                }
            },
            'mounts': {
                'ëª©ì„±ì–¸ë•': {
                    'icon': 'ğŸ”ï¸',
                    'title': 'ëª©ì„±ì–¸ë• (ê²€ì§€ ì•„ë˜)',
                    'analysis': '''ë„“ê³  ë°œë‹¬í•´ ë³´ì´ë‹ˆ ì ì¬ë ¥ì´ í’ë¶€í•˜ê³  ìì‹ ê°ì´ ë„˜ì¹˜ê³ , ë‹¨ë‹¨í•´ ë³´ì´ë‹ˆ ë¦¬ë”ì‹­ì´ ê°•í•˜ê³ , ë¶‰ì€ ê¸°ìš´ì´ ëŠê»´ì§€ë‹ˆ í™œë ¥ì´ ë„˜ì¹˜ê³  ìˆì–´.

ëª©ì„±ì–¸ë•ì€ ë‹¹ì‹ ì˜ ì•¼ë§ê³¼ ë¦¬ë”ì‹­ì„ ìƒì§•í•˜ëŠ” ê¶Œìœ„ì˜ ì–¸ë•ì´ì•¼. ë†’ê²Œ ì†Ÿì•„ìˆìœ¼ë‹ˆ í° ê¿ˆì„ í’ˆê³  ìˆê³ , ë„“ê²Œ í¼ì ¸ìˆìœ¼ë‹ˆ í¬ìš©ë ¥ë„ ë›°ì–´ë‚˜.

ë¦¬ë”ì‹­ì„ ë°œíœ˜í•  ê¸°íšŒê°€ ë§ì„ í…Œë‹ˆ ì‘ì€ ê²°ì •ì„ ìì‹  ìˆê²Œ í•´ë³´ì. ë‹¹ì‹ ì€ íƒ€ê³ ë‚œ ë¦¬ë”ì•¼!'''
                },
                'í† ì„±ì–¸ë•': {
                    'icon': 'ğŸ—»',
                    'title': 'í† ì„±ì–¸ë• (ì¤‘ì§€ ì•„ë˜)',
                    'analysis': '''ì ë‹¹í•œ ë†’ì´ë¡œ ë³´ì´ë‹ˆ ì•ˆì •ê°ì´ ìˆê³ , ë¶€ë“œëŸ¬ì›Œ ë³´ì´ë‹ˆ ìœ ì—°ì„±ì´ ê°•í•˜ê³ , ì°¨ë¶„í•œ ì—ë„ˆì§€ê°€ ëŠê»´ì§€ë‹ˆ ì¸ë‚´ì‹¬ì´ ë›°ì–´ë‚˜ê³  ìˆì–´.

í† ì„±ì–¸ë•ì€ ë‹¹ì‹ ì˜ ì±…ì„ê°ê³¼ ì¸ë‚´ë ¥ì„ ë³´ì—¬ì£¼ëŠ” ì‹ ì¤‘í•¨ì˜ ì–¸ë•ì´ì•¼. ê· í˜•ì¡íŒ ëª¨ìŠµì´ë‹ˆ ì„±ê¸‰í•˜ì§€ ì•Šê³  ì‹ ì¤‘í•˜ê²Œ íŒë‹¨í•´.

ê¾¸ì¤€íˆ ë‚˜ì•„ê°€ëŠ” ëª¨ìŠµì´ ë©‹ì§ˆ ê±°ì•¼. ë‹¹ì‹ ì˜ ì¸ë‚´ì‹¬ì´ í° ê²°ì‹¤ì„ ë§ºì„ ë•Œê°€ ì˜¬ ê±°ì•¼!'''
                },
                'íƒœì–‘ì–¸ë•': {
                    'icon': 'ğŸŒ…',
                    'title': 'íƒœì–‘ì–¸ë• (ì•½ì§€ ì•„ë˜)',
                    'analysis': '''ë¶€ë“œëŸ½ê³  ë„“ì–´ ë³´ì´ë‹ˆ ì°½ì˜ì„±ì´ í’ë¶€í•˜ê³ , ë¶‰ì€ ê¸°ìš´ì´ ë³´ì´ë‹ˆ í™œë ¥ì´ ë„˜ì¹˜ê³ , ë§¤ë ¥ì ì¸ ì—ë„ˆì§€ê°€ í˜ëŸ¬ì„œ ì‚¬ëŒë“¤ì„ ëŒì–´ë‹¹ê¸°ê³  ìˆì–´.

íƒœì–‘ì–¸ë•ì€ ë‹¹ì‹ ì˜ ì°½ì˜ë ¥ê³¼ ë§¤ë ¥ì„ ìƒì§•í•˜ëŠ” ë¹›ë‚˜ëŠ” ì–¸ë•ì´ì•¼. ë°œë‹¬ëœ ëª¨ìŠµì´ë‹ˆ ì˜ˆìˆ ì  ì¬ëŠ¥ì´ ìˆê³ , ë”°ëœ»í•œ ê¸°ìš´ì´ë‹ˆ ì‚¬ëŒë“¤ì—ê²Œ ì¸ê¸°ê°€ ë§ì•„.

ë§¤ë ¥ì„ ë°œíœ˜í•  ì¢‹ì€ ì‹œê°„ì´ë„¤. ë‹¹ì‹ ì˜ ì°½ì˜ì  ì—ë„ˆì§€ë¡œ ë§ì€ ì‚¬ëŒë“¤ì—ê²Œ ì˜ê°ì„ ì¤„ ìˆ˜ ìˆì„ ê±°ì•¼!'''
                },
                'ìˆ˜ì„±ì–¸ë•': {
                    'icon': 'ğŸ’',
                    'title': 'ìˆ˜ì„±ì–¸ë• (ìƒˆë¼ì†ê°€ë½ ì•„ë˜)',
                    'analysis': '''ë‹¨ë‹¨í•´ ë³´ì´ë‹ˆ ì˜ì§€ê°€ ê°•í•˜ê³ , ì ë‹¹í•œ í¬ê¸°ë‹ˆ ì†Œí†µ ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ê³ , ì§€ì ì¸ ì—ë„ˆì§€ê°€ ëŠê»´ì§€ë‹ˆ í•™ìŠµ ëŠ¥ë ¥ì´ ë›°ì–´ë‚˜ê³  ìˆì–´.

ìˆ˜ì„±ì–¸ë•ì€ ë‹¹ì‹ ì˜ ì†Œí†µ ëŠ¥ë ¥ê³¼ ìƒì—…ì  ê°ê°ì„ ë³´ì—¬ì£¼ëŠ” ì§€í˜œì˜ ì–¸ë•ì´ì•¼. ì„ ëª…í•œ ëª¨ìŠµì´ë‹ˆ ë§ì¬ì£¼ê°€ ì¢‹ê³ , ê· í˜•ì¡íŒ í¬ê¸°ë‹ˆ ì‹¤ìš©ì  ì§€í˜œê°€ ìˆì–´.

ëŒ€í™”ì—ì„œ ì¬ì¹˜ê°€ ë¹›ë‚  ê±°ì•¼. ë‹¹ì‹ ì˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ëŠ¥ë ¥ì´ í° ì„±ê³µì„ ê°€ì ¸ë‹¤ ì¤„ ê±°ì•¼!'''
                }
            }
        }

    def _preprocess(self, img: np.ndarray):
        """ì´ë¯¸ì§€ ì „ì²˜ë¦¬"""
        gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
        gray = cv2.equalizeHist(gray)
        blur = cv2.GaussianBlur(gray, (5, 5), 0)
        return gray, blur

    def analyze_palm_part(self, img: np.ndarray, part_type: str, part_name: str, dominant_hand: str = "ì˜¤ë¥¸ì†") -> Dict[str, Any]:
        """ê°œë³„ ì†ê¸ˆ ë¶€ìœ„ ë¶„ì„"""
        # ì‹¤ì œ ì´ë¯¸ì§€ ì „ì²˜ë¦¬
        gray, enhanced = self._preprocess(img)
        
        # í•´ë‹¹ ë¶€ìœ„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        if part_type == 'line':
            part_data = self.palm_data['lines'].get(part_name)
        else:  # mount
            part_data = self.palm_data['mounts'].get(part_name)
        
        if not part_data:
            return {
                'error': 'ì˜ëª»ëœ ë¶€ìœ„ ì´ë¦„ì…ë‹ˆë‹¤.',
                'part_type': part_type,
                'part_name': part_name
            }
        
        # ë¶„ì„ ê²°ê³¼ ë°˜í™˜
        return {
            'success': True,
            'part_type': part_type,
            'part_name': part_name,
            'dominant_hand': dominant_hand,
            'icon': part_data['icon'],
            'title': part_data['title'],
            'analysis': part_data['analysis'],
            'image_analyzed': True
        }

    def get_full_analysis(self, img: np.ndarray, dominant_hand: str = "ì˜¤ë¥¸ì†") -> Dict[str, Any]:
        """ì „ì²´ ì†ê¸ˆ ë¶„ì„ (ê¸°ì¡´ í˜¸í™˜ì„± ìœ ì§€)"""
        gray, enhanced = self._preprocess(img)
        
        # ê°„ë‹¨í•œ ì ìˆ˜ ê³„ì‚° (ëœë¤ + ì´ë¯¸ì§€ ê¸°ë°˜)
        h, w = gray.shape[:2]
        brightness = int(gray.mean())
        
        scores = {
            'relationships': min(100, max(60, 70 + (brightness % 20))),
            'creativity': min(100, max(60, 75 + ((h + w) % 25))),
            'health': min(100, max(60, 80 + (brightness % 15))), 
            'success': min(100, max(60, 72 + ((h * w) % 100) // 4))
        }
        
        return {
            'dominant_hand': dominant_hand,
            'scores': scores,
            'total_parts': 12,
            'analyzed': True
        }

# ê¸°ì¡´ í˜¸í™˜ì„±ì„ ìœ„í•œ í•¨ìˆ˜ë“¤
def analyze_image(img: np.ndarray, dominant_hand: str = "ì˜¤ë¥¸ì†"):
    """ê¸°ì¡´ API í˜¸í™˜ì„± í•¨ìˆ˜"""
    analyzer = PalmAnalyzer()
    result = analyzer.get_full_analysis(img, dominant_hand)
    
    features = {
        'dominant_hand': dominant_hand,
        'total_parts': 12
    }
    
    scores = result['scores']
    return features, scores

def analyze_palm_part(img: np.ndarray, part_type: str, part_name: str, dominant_hand: str = "ì˜¤ë¥¸ì†"):
    """ê°œë³„ ë¶€ìœ„ ë¶„ì„ í•¨ìˆ˜"""
    analyzer = PalmAnalyzer()
    return analyzer.analyze_palm_part(img, part_type, part_name, dominant_hand)

# ë‚´ë³´ë‚¼ ì‹¬ë³¼
__all__ = ["analyze_image", "analyze_palm_part", "PalmAnalyzer"]
